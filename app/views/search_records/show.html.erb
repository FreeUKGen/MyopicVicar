<div id="nav">
	<ul>
	    <li><%= link_to "New Search", new_search_query_path %></li>
	    <li><%= link_to "Revise Search", new_search_query_path(:search_id => @search_query) %></li>
	    <li><%= link_to "Back to Results", search_query_path(params[:search_id], :page_number => @page_number, :anchor => "#{@search_record.id}") %></li>
	</ul>
</div>


<% if @search_record.freereg1_csv_entry %>

    <table>
	<thead>
	    <tr>
		<td colspan="2">
		    <h1>Transcription</h1>
		    <% if @search_record.freereg1_csv_entry && @annotations && @annotations.length %>
		    <h2>Offline Transcriptions</h2>
		    <% end %>
		    <h3>Entry</h3>
		</td>
	    </tr>
	</thead>
	<tbody>
	    <% @search_record.freereg1_csv_entry.ordered_display_fields.each do |field| %>
			<% if @search_record.freereg1_csv_entry[field] %>
			    <tr>
				<td><%= field.gsub('_',' ').capitalize %></td>
				<td><%= @search_record.freereg1_csv_entry.display_field(field) %></td>
			    </tr>
			<% end %>
	    <% end %>
	</tbody>
    </table>

    <% file = @search_record.freereg1_csv_entry.freereg1_csv_file %>
    <% if file %>

	    <table>
			<thead>
			    <tr>
				<td colspan="2">
				    <h3>File</h3>
				</td>
			    </tr>
			</thead>
			<tbody>
				<% freereg1_csv_file_for_display(file).each do |name, value| %>
					<tr>
						<td><%= name %></td>
						<td><%= value %></td>
					</tr>
				<% end %>
		
			</tbody>
	    </table>
	<% end%>
<% end%>


<% if @annotations && @annotations.length > 0 %>

    <table>
	<thead>
	    <tr>
		<td colspan="2">
		    <h2>Online Transcriptions</h2>
		</td>
	    </tr>
	</thead>
	<tbody>
	    <% @annotations.each do |annotation| %>
		<% annotation.attributes.keys.each do |field| %>
		    <% if annotation[field] %>
			<tr>
			    <td><%= field.gsub('_',' ').capitalize %></td>
			    <td><%= annotation[field] %></td>				
			</tr>
		    <% end %>
		<% end %>
		<% transcription = annotation.transcription %>
		<% if transcription %>
		    <% transcription.attributes.keys.each do |field| %>
				<% if transcription[field] %>
				    <tr>
					<td><%= field.gsub('_',' ').capitalize %></td>
					<td><%= transcription[field] %></td>				
				    </tr>
				<% end %>
		    <% end %>
		    <tr>
			<td>Image</td>
			<td>
			    <% if transcription.asset.thumbnail_location %>
				<%= link_to(image_tag(transcription.asset.thumbnail_location), transcription.asset.location) %>
			    <% else %>			
				<%= link_to("Image", transcription.asset.location) %>
			    <% end %>
			</td>				
		    </tr>
		<% end %>
	    <% end %>
	</tbody>
    </table>
<% end%>

<% unless params[:debug].blank? %>
	<table>
	    <thead>
		<tr>
		    <td colspan="2">
			<h1>Record</h1>
		    </td>
		</tr>
	    </thead>
	    <tbody>
		<tr>
		    <td>Primary names</td>
		    <td>
			<% @search_record.primary_names.each do |name| %>
			    first_name: <%= name.first_name %><br/>
			    last_name: <%= name.last_name %><br/>
			    origin: <%= name.origin %><br/>
			<% end %>
		    </td>
		</tr>
		<tr>
		    <td>Other family names</td>
		    <td>
			<% @search_record.inclusive_names.each do |name| %>
			    first_name: <%= name.first_name %><br/>
			    last_name: <%= name.last_name %><br/>
			    origin: <%= name.origin %><br/>
			<% end %>
		    </td>
		</tr>
		<% @search_record.ordered_display_fields.each do |field| %>
		    <% if @search_record[field] %>
			<tr>
			    <td><%= field.gsub('_',' ').capitalize %></td>
			    <td><%= @search_record[field] %></td>
			</tr>
		    <% end %>
		<% end %>
	    </tbody>
	</table>
<% end %>
