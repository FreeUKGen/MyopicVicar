<!--p class="text--right">
  <%#= link_to "New Search", new_search_query_path, :class => "btn   btn--small bordered push-half--right" %>
  <%#= link_to "Revise Search", new_search_query_path(:search_id => @search_query), :class => "btn   btn--small bordered push-half--right" %>
  <%#= link_to "Printable Format", '#', :class => "btn   btn--small bordered push-half--right"%>
  <--a href="#" id="citation-toggle" class="btn   btn--small bordered push-half--right citation-toggle">Generate Citation</a>
  </p-->
<!--h1 class="title">Entry Information</h1>
<p>Has our search engine found the record you are seeking? The next step is to ordering your certificate ! Click on Ordering Certificates to learn what to do now.</p-->
<% breadcrumb :entry_information, @current_record  unless @search %>
<%= render 'flash_notice' %>

<% title "Record Details" %>
<div class="grid">
  <div class="grid__item seven-tenths lap-seven-tenths palm-one-whole">
    <div class="grid__item one-third lap-one-third palm-one-half hard--left">
      <%= link_to "#{app_icons[:left_arrow_pink]} Back to Results".html_safe, search_query_path(@search_query, id: params[:search_id], anchor: @anchor_entry), class: " btn   btn--small" if params[:search_id].present?%>
    </div>
    <div class="grid__item one-third lap-one-third palm-one-half float--right">
      <%#= form_tag friendly_bmd_record_details_path(params[:search_id], @search_record, @search_record.friendly_url), method: :get, id: 'option_form' do %>
        <%#= select_tag('filter_option', options_for_select([['Scan', "1"], ['Postems', "2"], ['Printable Format', "3"]], selected: @option), {:prompt => "More Options", id: 'filter_results', tabindex: "0", onchange: "more_options()"}) %>
      <%# end %>
      <!--div id="tool_button" class="btn btn--small float--right" onclick="myFunction()"><i class="fa fa-cog" aria-hidden="true"></i> More Options</div-->
    </div>  
    
  </div>
</div>

<%#= link_to "#{app_icons[:left_arrow_pink]} Back".html_safe, search_query_path(@search_query, id: params[:search_id]), class: " btn   btn--small" if params[:search_id].present?%>
<% print_friendly = (defined?(@printable_format) && @printable_format) ? true : false %>
  <div class="grid">
    <div class="grid__item seven-tenths lap-seven-tenths palm-one-whole ">
      <h1 class="beta push-half--top flush--bottom"><%= "Entry Information: #{@current_record[:GivenName].camelize} #{@current_record[:Surname].upcase}" %></h1>
      <hr>
      <!--span  class='additional'>
        While we have made all efforts to correctly record the information in the original document there may be different interpretations of the written words. <b>If you have access to the original document</b> and believe we have made a mistake you are encouraged to report this to us.
        <%= link_to 'Report an Error in this Data', report_error_contact_path(@current_record.RecordNumber, query: @search_query), class: 'btn btn--natural' unless  @current_record.blank? || @search_query.blank? %>
      </span-->
      <section>
        <div class="grid__item two-thirds lap-two-thirds palm-one-whole hard--left">
          <% record_type = RecordType::display_name(@current_record.RecordTypeID)%>
          <%= render partial: 'entry_information_table', locals: {record: @current_record, search: true, entry_type: record_type.downcase, query: @search_query, search_id: params[:search_id], original_record: @current_record, more_info: false } %>
        </div>
        
        <div class='push-half--top'>
          <div class="grid__item one-whole">
            <% if params[:search_id].present? %>
              <div class='grid__item one-quarter lap-one-quarter palm-one-half'>
                <%= link_to '<i class="fa fa-chevron-left view_arrow"></i> Previous Result'.html_safe, friendly_bmd_record_details_path(params[:search_id], @previous_record, @previous_record.friendly_url), class: 'push-half--right push-half--top push--bottom' unless @previous_record.nil? %>
              </div>
              <div class='grid__item one-quarter lap-one-quarter palm-one-half'>
                <%= link_to 'Next Result <i class="fa fa-chevron-right view_arrow"></i>'.html_safe, friendly_bmd_record_details_path(params[:search_id], @next_record, @next_record.friendly_url), class: 'push-half--right push-half--top push--bottom' unless @next_record.nil?%>
              </div>
              <% if @previous_record_of_page.present?%>
              <div class='grid__item one-quarter lap-one-quarter palm-one-half'>
                
                  <%= link_to 'Previous in Page'.html_safe, friendly_bmd_record_details_path(params[:search_id], @previous_record_of_page, @previous_record_of_page.friendly_url, search_entry: @current_record), class: 'push-half--right push-half--top' %>
                
              </div>
              <% end %>
              <% if @next_record_of_page.present?%>
              <div class='grid__item one-quarter lap-one-quarter palm-one-half'>
                
                  <%= link_to 'Next in Page'.html_safe, friendly_bmd_record_details_path(params[:search_id], @next_record_of_page, @next_record_of_page.friendly_url, search_entry: @current_record), class: 'push-half--right push-half--top' %>
                
              </div>
              <% end %>
            <% end %>
          </div>
        </div>
        </section>
      
      <% if @option == '1' %>
        <div id="display_scans">
          <div class="grid__item two-thirds lap-two-thirds palm-one-whole hard--left">
            <h4>Scans</h4>
          </div>
          <div class="grid__item two-thirds lap-two-thirds palm-one-whole hard--left">
            <table class="table--bordered table--data ">
              <thead>
                <th>Scan</th>
                <th>View Scan</th>
              </thead>
              <tbody>
                <% if @scan_links.present? %>
                  <% @scan_links.each do |s| %>
                      <% series = s.SeriesRangeFileName %>
                      <% image_file_path = "#{scan_link_url(@current_record)}#{series}" %>
                      <tr>
                        <td><%= image_tag(image_file_path,size: "100x100")%></td>
                        <td><%= link_to "#{series}".html_safe, image_file_path, target: "_blank"%></td>
                      </tr>
                  <% end %>
                <% end %>
                <% if @acc_scans.present? %>
                  <% @acc_scans.each do |s| %>
                      <% series = s.SeriesID %>
                      <% range = "/#{s.range.Range}" if s.Range.present?%>
                      <% file = s.Filename %>

                      <% image_file_path = "#{scan_link_url(@current_record)}#{series}#{range}/#{file}" %>
                      <tr>
                        <td><%= image_tag(image_file_path,size: "100x100")%></td>
                        <td><%= link_to "#{series}#{range}/#{file}".html_safe, image_file_path, target: "_blank"%></td>
                      </tr>
                  <% end %>
                <% end %>
                <% if @acc_mul_scans.present? %>
                  <% @acc_mul_scans.each do |s| %>
                      <% series = s.SeriesID %>
                      <% range = "/#{s.Range}" if s.Range.present?%>
                      <% @current_record.multi_image_filenames.each do |fn| %>
                        <% image_file_path = "#{scan_link_url(@current_record)}#{series}#{range}/#{fn}" %>
                        <tr>
                          <td><%= image_tag(image_file_path,size: "100x100")%></td>
                          <td><%= link_to "#{series}#{range}/#{fn}".html_safe, image_file_path, target: "_blank"%></td>
                        </tr>
                      <% end %>
                  <% end %>
                <% end %>
              </tbody>
            </table>
          </div>
          <div class="grid__item two-thirds lap-two-thirds palm-one-whole hard--left">
            <p>If the scan does not contain the entry you may be able to find the scan yourself by clicking <%= link_to "here(link opens in new tab)", "https://images.freebmd.org.uk/cgi/choose.pl", target: "_blank"%></p>
          </div>
        </div>
      <% end %>
      <% if @option == '2' %>
        <div id="display_postems">
          <div class="grid__item two-thirds lap-two-thirds palm-one-whole push--bottom hard--left">
            <h4>Postems</h4>
            <p>Do you know more about the people or event in this record that you are willing to share with other researchers? We call these helpful additions to the database 'postems'. For example, you you know a more precise place or other details from a certificate or from a search of FreeREG, or more about the family from a search on FreeCEN, or have found other records about them in another country's registration system. Contribute what you know</p>
            <% if @current_record.postems_list.present? %>
              <p>Below are the list of postems</p>
              <table class="table--bordered table--data">
                <thead>
                  <th>Date</th>
                  <th>Postem</th>
                </thead>
                <tbody>
                  <% @current_record.postems_list.each do |postem|%>
                    <tr>
                      <td>
                        <%= DateTime.strptime("#{postem.Created}",'%s').to_date if postem.Created.present?%>
                      </td>
                      <td>
                        <%= auto_link(postem.Information, :html => { :target => '_blank' }) %>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            <% end%>
            <p id="create_postem">Add a postem</p>
            <div class="create_postem_div">
              <%= semantic_form_for(@new_postem) do |f| %>
                <%= f.hidden_field('honeypot', value: @new_postem[:honeypot])%>
                <%= f.hidden_field('Hash', value: @new_postem.Hash) %>
                <%= hidden_field_tag('search_query', @search_query.id) if @search %>
                <ol class="grid">
                  <li class="grid__item desk-wide-three-quarters desk-three-quarters lap-three-quarters palm-one-whole push--bottom">
                    <%= text_area_tag 'postem[Information]', nil, rows: 7, style: 'width: 100%'%>
                  </li>
                
                  <div class="grid__item desk-wide-one-whole desk-one-whole lap-one-whole palm-one-whole">
                    <%= button_tag 'Add Postem', type: :submit, class: 'ladda-button kittumani' , id: 'postem_form_submit', data: {style: "contract" , color: appname.downcase, size: "s", "spinner-color" => "#ffffff"}%>
                  </div>
                </ol>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
      <div class="grid__item two-thirds lap-two-thirds palm-one-whole text--center push--top ">
          <%= link_to 'Report an Error in this Data', report_error_contact_path(@current_record.RecordNumber, query: @search_query), class: 'btn btn--natural' unless  @current_record.blank? %>
        </div>
    </div>
    <% unless print_friendly %>
      <% if device_type == :desktop %>
        <div class="grid__item two-tenths lap-one-tenths palm-one-whole"  id='results_table_ad'>
          <center>
            <p>Advertisement</p>
            <%= adsence_right_side_banner %>
          </center>
        </div>
      <% end %>
    <% end %>

      
  </div>

  <script type="text/javascript">
    function more_options(){
      $('#option_form').submit();
    };
    $("#create_postem").click(
      function() {
        $(".create_postem_div").show();
        $("#create_postem").hide();
    });
  </script>