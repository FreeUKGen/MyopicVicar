<p class="text--center"><%= link_to 'Detailed Advice on Searching', "../tips-for-searching-the-database", method: :get, :class => "btn  btn--small"  %><%= link_to "Data on the Database Contents", main_app.freereg_contents_path , method: :get, :class => "btn  btn--small" %></p>
  
  <div style="clear:both;"> </div>
        <section class="island  island--light">

<%= semantic_form_for(@search_query) do |f| %>

  <%= f.semantic_errors :class => "validation-list__error" %>

    <%= f.input :last_name, 
    			:input_html => 
    				{ 	:size => 20, 
    					:class => "text-input" }, :wrapper_html => {  :class => "grid__item  one-quarter  palm-one-whole"} 
				 %>
  
    <%= f.input :first_name, 
    			:input_html => 
    				{ 	:length => 10, 
						:size => 20,  
						:class => "text-input" }, :wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" } 
				   
           %>

   
    <%= f.input :start_year, :input_html => {:length => 4, :size => 4,  :class => "text-input"} , :wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" }%>
    <%= f.input :end_year, :input_html => {:length => 4, :size => 4,  :class => "text-input" }, :wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" } %>
   

    <li class="grid__item  one-quarter  palm-one-whole " id="search_query_chapman_codes_input">
    	<input name="search_query[chapman_codes][]" type="hidden" value="" />
    	<label class=" label" for="search_query_chapman_codes">
    		County
		</label>
		<input name="search_query[chapman_codes][]" type="hidden" value="" />
		<select class="select" id="search_query_chapman_codes" multiple="multiple" name="search_query[chapman_codes][]">
			<option value=""></option>
			<% ChapmanCode::select_hash_with_parenthetical_codes.each_pair do |label, value| %>
				<option value="<%=value%>"><%=label%></option>
			<% end %>
		</select>
	</li>

    <li class="select grid__item  one-quarter  palm-one-whole"  id="search_query_places_input">
		<label class=" label" for="search_query_place_ids">Place</label>
		<select id="search_query_place_ids" name="search_query[place_ids][]" class="select" >
			<option value="">--</option>
		</select>	
	</li>

 <%= f.input :fuzzy, 
          :as => :boolean, :label => "Soundex Search on Surnames?",
          :input_html => {:class => "checkbox"} , 
          :wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" } %>
       
  
	
	<%= f.input :search_nearby_places, 
				:as => :boolean,
				:label => "Search nearby places?",
         		:input_html => { :class => "checkbox" }, 
         		:wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" } %>


    <%= f.input :inclusive, 
    			:as => :boolean, 
				:label => "Search family members?",
     		  	:input_html => { :class => "checkbox" }, 
     		  	:wrapper_html => { :class => "grid__item  one-quarter  palm-one-whole" } %>
  
  
	  <li class="grid__item  one-quarter  palm-one-whole optional" id="search_query_record_type_input">
	  	<label class=" label" for="search_query_record_type">
	  		Record type
  		</label>
  		<select id="search_query_record_type" name="search_query[record_type]" class="select">
  			<option value=""></option>
  			<% RecordType::OPTIONS.each_pair do |name, value| %>
  				<option value="<%=value%>"><%=name%></option>
			<% end %>
		</select>
	</li>

  
    <%= f.action :submit, 
    			:as => :button, 
    			:label => 'Search',
    			:button_html => { :class => "btn", :type => 'submit' }, 
     		  	:wrapper_html => { :class => "grid__item  one-whole  text--right" }  %>

<% end %>



</section>


<script type="text/javascript" charset="utf-8" >
	<% if @search_query && @search_query.chapman_codes.size > 0 %>
	    var selection=<%= raw(PlaceCache.where(:chapman_code => @search_query.chapman_codes.first).first.places_json) %>;
     	<% if @search_query.places.size > 0 %>
			selection["selected"]="<%= @search_query.places.first.id %>";	 
		<% end %>
	<% end %>

	
	(function($) {$("#search_query_place_ids").remoteChained({
	  parents : "#search_query_chapman_codes",
	  url : "/places/for_search_form.json",
	  loading : "Loading..."
	  <% if @search_query && @search_query.chapman_codes.size > 0 %>
	  , bootstrap: selection
	  <% end %>
	});})(jQuery);
	
</script>

