<div style="overflow: hidden;">
  <table class="my-width-min flush--bottom" >
    <thead>
      <tr>
        <th class="t12">User</th>
        <th class="t12">Status</th>
        <th class="t12">Image</th>
        <th class="t12">Date</th>
        <th class="t12">Instructions</th>
        <th class="t10" colspan=2>Action
          <a href="#" class="left_tooltip"><%= image_tag 'info.png', alt: 'Information', height: '14' %>
          <span>RM: Remove Image from Assignment; VW: View Original Image; DL: Download Original Image; COM: Assignment has Completed; UN: Unassign Images in This Assignment; RA: Re_assign Images in This Assignment; ER: Change Image Status in This Assignment as ERROR</span></a>
        </th>
      </tr>
    </thead>
  </table>

  <div class="scrollable">
    <table class=" table--bordered my-width table--data just--left">
      <tbody>
        <% prev_id = '' %>
        <% if @assignment.nil? %>
          No Assignment Exists
        <% else %>
          <% @assignment.each do |x| %>
            <tr>
              <% rows = x[:_id] != prev_id ? @count[x[:_id]] : 0 %>

              <% if x[:_id] != prev_id %>
                <td class="t12"><%= x[:userids][:userid] if !x[:userids].nil? %>&nbsp;</td>
                <td class="t12"><%= ImageServerImage::Status::ALL_STATUSES[x[:images][:status]] if !x[:images].nil? %>&nbsp;</td>
                <% prev_id = x[:_id] %>
              <% else %>
                <td class="t12">&nbsp;</td><td class="t12">&nbsp;</td>
              <% end %>

              <td class="t12"><%= x[:images][:image_name]+'_'+x[:images][:seq] if !x[:images].nil? %>&nbsp;</td>
              <td class="t12"><%= x[:assign_date].to_date.strftime("%Y-%m-%d") %>&nbsp;</td>
              <td class="t12"><%= x[:instructions] %>&nbsp;</td>
              <% assignment_type = x[:images][:status] == 'ip' ? 'transcriber' : 'reviewer' %>
              <td class="t5">
                <%= link_to 'RM', assignment_path(x[:images][:_id], :assign_type=>assignment_type), data: { confirm: 'Are you sure you want to remove this image from assignment?' }, method: :delete if !x[:images].nil? %>
                <%= link_to 'VW', view_image_server_image_path(:object=>x[:images][:_id]), method: :get, :target=>'_blank' %>
                <%= link_to 'DL', download_image_server_image_path(:object=>x[:images][:_id]), method: :get, :target=>'_blank' %>
              </td>

              <% if rows != 0 %>
                <td class="t5" rowspan=<%= rows %> style="vertical-align:top">
                  <% if params[:assignment].nil? %>
                    <% assignment_list_type = params[:assignment_list_type] %>
                  <% else %>
                    <% assignment_list_type = params[:assignment][:assignment_list_type] %>
                  <% end %>

                  <%= link_to 'COM', assignment_path(x[:_id], :status=>x[:images][:status], :type=>'complete', :assignment_list_type=>assignment_list_type), data: { confirm: 'Click OK if the assignment has been Completed' }, method: :put %>
                  <%= link_to 'UN', assignment_path(x[:_id], :status=>x[:images][:status], :type=>'unassign', :assignment_list_type=>assignment_list_type), data: { confirm: 'Click OK to un-assign the assignment'}, method: :put %>
                  <%= link_to 'RA', re_assign_assignment_path(x[:_id], :image_server_group_id=>x[:images][:image_server_group_id], :assign_type=>assignment_type, :assignment_list_type=>assignment_list_type), data: { confirm: 'Do you want to re-assign images in this assignment?'} %>
                  <% if x[:images][:status] == 'ir' %>
                    <%= link_to 'ER', assignment_path(x[:_id], :status=>x[:images][:status], :type=>'error', :assignment_list_type=>assignment_list_type), data: { confirm: 'Click OK if you want to mark all images in this assignment as ERROR'}, method: :put %>
                  <% end %>
                </td>
              <% end %>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<div style="clear:both;"></div><br>
